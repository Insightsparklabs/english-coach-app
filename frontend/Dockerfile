FROM python:3.11-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
COPY . .
# Streamlit ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ8501ã§èµ·å‹•
# CMD [ "streamlit", "run", "main.py", "--server.address=0.0.0.0" ]

# ==========================================
# ğŸŒŸ é­”æ³•ã®æ›¸ãæ›ãˆï¼ˆOGPã‚¿ã‚°ã®å¼·åˆ¶åŸ‹ã‚è¾¼ã¿ï¼‰
# ==========================================
# Streamlitã®æœ¬ä½“(index.html)ã‚’æ¢ã—å‡ºã—ã€</head>ã®ç›´å‰ã«SNSã‚·ã‚§ã‚¢ç”¨ã®ã‚¿ã‚°ã‚’ã­ã˜è¾¼ã¿ã¾ã™
RUN SITE_PACKAGES=$(python -c "import site; print(site.getsitepackages()[0])") && \
    sed -i 's|</head>|<meta property="og:title" content="g-book AI English Coach" /><meta property="og:description" content="1å¹´ã§Versant C1ã‚’ç›®æŒ‡ã™ã€ã‚ãªãŸå°‚ç”¨ã®ä¼´èµ°è€…" /><meta property="og:image" content="ã€ã“ã“ã«ç”»åƒã®URLã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ã€‘" /><meta name="twitter:card" content="summary_large_image" /></head>|g' $SITE_PACKAGES/streamlit/static/index.html

# --- (å…ƒã‹ã‚‰ã‚ã‚‹CMDã‚³ãƒãƒ³ãƒ‰) ---
CMD ["streamlit", "run", "main.py", "--server.port=8501", "--server.address=0.0.0.0"]